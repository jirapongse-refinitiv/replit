var modalId="",confId="",contextHubObj="undefined"!==typeof ContextHub&&ContextHub.getItem("userData");if(contextHubObj&&null!==contextHubObj.userProfile)var userPreferenceObj=contextHubObj.userProfile.userPreferences[0],userInfoObj=contextHubObj.userProfile.userInfo;
$(document).ready(function(){modalId="modal-feedbackModal";confId=$("#"+modalId+" .confdiv").attr("id");var b=$("#"+modalId+" #constraintsAsString").text(),c=JSON.parse(b);$("form").each(function(){$(this).attr("id")===$("#"+modalId).find("form").attr("id")&&$(this).validate({ignore:":not(:visible),:disabled",onkeyup:function(a){$(a).valid()},rules:c.rules,messages:c.messages,submitHandler:function(a){feedbackajaxCall()},showErrors:function(a,b){if(isFormSubmitted){isFormSubmitted=!1;for(a=0;a<b.length;a++)formErrors.push("Invalid "+
b[a].element.name);logAnalyticsFormError(formErrors.toString())}this.defaultShowErrors()}})});$("#globalHeader-left-2").on({"click tap":function(){$(this).removeAttr("href");$("#"+modalId+" #message").val("");$("#"+confId+"-feed__attachments-list").html("");$("#"+modalId+" label[class\x3d'error'").text("");$("#"+modalId).find("form button").removeClass("is-disabled");$("#"+modalId+" .modal-header-text button").attr("onclick","closeClick(this)");$("#"+confId).parent().css("margin-top","12px");$("#"+
confId).css("min-height","110px");$("#"+modalId+" form").find("button").css("margin-top","32px");$("#"+modalId+" #feedbacktype").val($("#"+modalId+" #feedbacktype option:first").val());setDefaultFieldValues();$("#"+modalId).show();$(".tr-Modal-content:visible").scrollTop(0);$("#"+modalId+" #feedbacktype").attr("onchange","FeedbacktypeChange()");"reportProblem"!==$("#"+modalId+" #feedbacktype").val()&&($("#"+modalId+" #problemtype").val(""),$("#"+modalId+" #problemtypeWrapper").hide())}});$("#ThankyouErrorModal  button").click(function(){location.reload()})});
function FeedbacktypeChange(){"reportProblem"===$("#"+modalId+" #feedbacktype").val()?($("#"+modalId+" #problemtype").val($("#"+modalId+" #problemtype option:first").val()),$("#"+modalId+" #problemtypeWrapper").show()):($("#"+modalId+" #problemtype").val(""),$("#"+modalId+" #problemtypeWrapper").hide())}
function setDefaultFieldValues(){$("#"+modalId+" #feedbackfirstname").val(userInfoObj.address.firstName);$("#"+modalId+" #feedbacklastname").val(userInfoObj.address.lastName);$("#"+modalId+" #feedbackemail").val(userInfoObj.address.emailAddress);$("#"+modalId+" #feedbackSubject").val("Developer Portal Feedback")}
function feedbackajaxCall(){$("#"+modalId).find("form button").addClass("is-disabled");var b=$("#"+modalId+" #problemtype  option:selected").text(),c=$("#"+modalId+" #message").val(),a=userInfoObj.address.country,e=$("#"+modalId+" #feedbackSubject").val(),d=$("#"+modalId+" #feedbackfirstname").val(),f=$("#"+modalId+" #feedbacklastname").val(),g=$("#"+modalId+" #feedbackemail").val(),h=$("#"+modalId+" #feedbacktype option:selected").text();$.ajax({url:"/bin/devportal/generatecase",data:{problemType:b,
message:c,feedbackCountry:a,feedbackSubject:e,feedbackFirstname:d,feedbackLastname:f,feedbackEmail:g,feedbackType:h},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",dataType:"html",cache:!1,type:"POST",success:function(a){a=JSON.parse(a);if(200===a.resCode||201===a.resCode)if(0<$("#"+confId+"-feed__attachments-list").children().length){var b=a.resResult.code?a.resResult.code:"";attachServlet(a.resResult.id?a.resResult.id:"0",b)}else b=a.resResult.code?a.resResult.code:"",showFeedbackSuccessModal(b);
else showFeedbackErrorModal()},error:function(a){showFeedbackErrorModal()}})}
function attachServlet(b,c){var a=JSON.parse($("#Feedback-Modal #attachmentId").val()),e=JSON.parse($("#Feedback-Modal #fileArr").val()),d=[];$.each(a,function(a,b){d.push({fileContent:b,fileName:e[a]})});$.ajax({url:"/bin/devportal/uploaddevportalattachment",data:{id:b,uploadData:JSON.stringify(d),emailAddress:$("#"+modalId+" #feedbackemail").val(),flag:"feedback"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",dataType:"html",cache:!1,type:"POST",success:function(a){"true"!==
JSON.parse(a).success&&$("#ThankyouErrorModal #showUploadError").show();showFeedbackSuccessModal(c)},error:function(a){$("#ThankyouErrorModal #showUploadError").show();showFeedbackSuccessModal(c)}})}function showFeedbackSuccessModal(b){$("#"+modalId).hide();$("#ThankyouErrorModal #feedbackSuccessHeading").show();$("#ThankyouErrorModal #ticketNumber").html(b);$("#ThankyouErrorModal .ticketHeading").show();$("#ThankyouErrorModal #showModalsuccess").show();$("#ThankyouErrorModal").show()}
function showFeedbackErrorModal(){$("#"+modalId).hide();$("#ThankyouErrorModal #failureHeading").show();$("#ThankyouErrorModal #showModalError").show();$("#ThankyouErrorModal").show()};